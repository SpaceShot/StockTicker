<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Philly.NET SignalR Stock Ticker</title>
    <link href="~/Content/simpleTheme.css" rel="stylesheet" />
</head>
<body>

    <script src="~/Scripts/jquery-1.6.4.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.0.0.min.js"></script>
    <script src="/signalr/hubs"></script>

    
    <script type="text/javascript">
        $(function () {
            var stockHub = $.connection.stockHub;

            stockHub.client.stockUpdated = function (stock) {
                updateStock(stock);
            };

            $.connection.hub.start();
        });

        function updateStock(stock) {
            var tr = document.querySelector('.' + stock.Symbol);
            tr.innerHTML = '<td>' + stock.Symbol + '</td>' +
            '<td>' + stock.Price + '</td>' +
            '<td>' + stock.DayOpen + '</td>' +
            '<td>' + stock.Change + '</td>' +
            '<td>' + stock.PercentChange + '</td>';
        }
    </script>


    <img src="~/Images/logo.png" />
    <h1>SignalR Stock Ticker Sample</h1>

    <h2>Index</h2>

    <h2>Stock Report</h2>
    <div id="stockTable">
        <table border="1">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Price</th>
                    <th>Open</th>
                    <th>Change</th>
                    <th>%</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var stock in ViewBag.Stocks)
                {
                    <tr class="@stock.Symbol">
                        <td>@stock.Symbol</td>
                        <td>@stock.Price</td>
                        <td>@stock.DayOpen</td>
                        <td>@stock.Change</td>
                        <td>@stock.PercentChange</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</body>
</html>
